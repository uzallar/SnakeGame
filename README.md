# 🐍 Змейка (Snake Game) - MVVM


# 📜 Правила игры "Змейка" для новичков

## 🔐 Перед игрой: регистрация
Сначала нужно зарегистрироваться → **придумай никнейм и пароль**.  
Потом выполни вход → **введи придуманный никнейм и свой пароль**.

---

## 🎯 Цель игры
**Управляй змейкой 🐍, чтобы она ела еду (🍎).**  
✔️ Чем больше еды съешь — тем длиннее змейка и выше счёт!  
❌ Не врезайся в стены и в себя — иначе проиграешь!  

💯 За каждую съеденную еду **+10/20/30 очков**

---

## 🎮 Как управлять?
Используй стрелки (←↑→↓) или клавиши **WASD**:

- ↑ / W — вверх  
- ↓ / S — вниз  
- ← / A — влево  
- → / D — вправо  

🚫 **Нельзя резко развернуться!**  
(Если змейка ползёт вправо → нельзя сразу повернуть влево ←)

---

## ⚙️ Настройки скорости
Можно выбрать 3 уровня сложности:

- 🐢 **Медленно (Slow)** — для новичков  (+10 очков)
- 🐇 **Средне (Medium)** — нормальная скорость (**по умолчанию**)  (+20 очков)
- 🚀 **Быстро (Fast)** — сложный режим для опытных (+30 очков)

---

## ⏯️ Меню игры (ESC)
При нажатии **ESC** появляется меню:

- **Продолжить** — вернуться в игру  
- **Рестарт** — начать заново  
- **Сменить сложность** — изменить скорость змейки  
- **Таблица лидеров** — посмотреть лучшие результаты  
- **Сменить пользователя** — выйти из аккаунта  
- **Выход** — закрыть игру

---

## 🏆 Таблица рекордов
Твой максимальный счёт сохраняется, **если ты играешь под своим ником**.  
Можно посмотреть, **кто в топе!**

---

## 💡 5 советов для новичков
1️⃣ Сначала играй на **медленной скорости** — привыкнешь к управлению.  
2️⃣ Не жми кнопки слишком часто — змейка **поворачивает не мгновенно!**  
3️⃣ Двигайся **по краям** — так проще избежать столкновений.  
4️⃣ **Следи за хвостом** — чем длиннее змейка, тем сложнее!  
5️⃣ Пробуй **разные скорости** — когда освоишься, переходи на быстрый режим.

---

🎮🔥 **Удачи! Ставь рекорды!**




# 🏗️ Архитектура
# Model
## 🧠 SnakeGameModel.cs  - Основная игровая логика (движение змейки, генерация еды, подсчет очков)
📌 Назначение

Отвечает за всю игровую логику:
- Состояние змейки и еды
- Физику движения
- Обработку столкновений
- Подсчёт очков

🔑 Ключевые свойства
```

public List<Point> SnakeParts { get; }  // Сегменты змейки (координаты)
public Point SnakeHeadPosition { get; } // Позиция головы (X,Y)
public Vector SnakeDirection { get; }   // Направление (в пикселях)
public Point FoodPosition { get; }      // Позиция еды
public int Score { get; }               // Текущий счет
```

🎮 Основные методы

| Метод                | Описание                                                                 |
|----------------------|--------------------------------------------------------------------------|
| `InitializeGame()`   | Сбрасывает игру в начальное состояние: <br>- Позиционирует змейку по центру <br>- Генерирует первую еду <br>- Обнуляет счет |
| `MoveSnake()`        | Перемещает змейку по текущему направлению: <br>- Голова двигается вперед <br>- Каждый сегмент занимает позицию предыдущего |
| `CheckCollisions()`  | Проверяет столкновения: <br>- С границами игрового поля <br>- С собственным хвостом <br>*(Возвращает `true` при обнаружении столкновения)* |
| `CheckFoodCollision()`| Обрабатывает сбор еды: <br>- Добавляет +10 очков <br>- Увеличивает длину змейки <br>- Генерирует новую еду в случайном месте |


## 👤 User.cs - Модель пользователя (логин, пароль, рекорды)

#### 🎯 Назначение
Класс `User` представляет сущность игрока в системе и используется для:
- Аутентификации и авторизации
- Хранения игровых достижений
- Работы с таблицей лидеров

#### 📌 Свойства класса

| Свойство        | Тип     | Описание                                  | Пример значения       |
|-----------------|---------|------------------------------------------|-----------------------|
| `Id`           | `int`   | Уникальный идентификатор пользователя    | `42`                 |
| `Username`     | `string`| Логин игрока (уникальный)                | `"player123"`        |
| `PasswordHash` | `string`| Хэш пароля (SHA256)                      | `"a1B2c3D4e5F6..."`  |
| `MaxScore`     | `int`   | Лучший результат игрока                  | `1250`               |


## 🗃️ Database Helper (DBHelper.cs) - Работа с базой данных (сохранение/загрузка результатов)


#### 📌 Назначение
Статический класс для работы с PostgreSQL базой данных:
- Аутентификация пользователей
- Регистрация новых аккаунтов
- Обновление рекордов
- Получение таблицы лидеров

#### 🔑 Ключевые методы

| Метод                     | Описание                                                                 |
|---------------------------|--------------------------------------------------------------------------|
| `CreateUser()`            | Регистрирует нового пользователя с хешированием пароля                   |
| `GetUserByUsername()`     | Получает данные пользователя по логину                                   |
| `ValidateUser()`          | Проверяет соответствие логина и пароля                                   |
| `UpdateMaxScore()`        | Обновляет рекорд пользователя (если новый результат лучше)               |
| `GetTopPlayers()`         | Возвращает топ игроков по максимальному счету                           |
| `HashPassword()`          | Внутренний метод для хеширования паролей (SHA256)                       |

#### 🔐 Безопасность
- Все пароли хранятся в виде хешей (SHA256)
- Нет прямого хранения/передачи чистых паролей
- Используются параметризованные запросы для защиты от SQL-инъекций
 

# ViewModel
## SnakeViewModel.cs 
## LeaderBoardViewModel.cs
## DifficulitySelectionViewModel.cs
## LoginViewModel.cs
## PinkMessageBoxViewModel.cs
## StartWindowViewModel.cs


## 🎮 RelayCommand - Реализация команд для SnakeGame
#### 📌 Назначение
- Связывать UI-элементы (кнопки, меню) с логикой ViewModel
- Реализовывать паттерн MVVM
- Управлять доступностью команд

#### 🔧 Основные компоненты
1. Поля класса
 - execute - действие, выполняемое командой

- canExecute - условие выполнения (опционально)

2. Конструктор

   Принимает:

- Обязательный параметр execute - метод для выполнения

- Опциональный параметр canExecute - условие выполнения

3. Методы
- CanExecute() - определяет, доступна ли команда
- Execute() - выполняет основную логику команды

4. Событие
- CanExecuteChanged - автоматически обновляет состояние привязанных UI-элементов
#### 📌 Применение в проекте
   Используется для обработки:

- Старта/паузы игры
- Управления направлением змейки
- Настройки параметров игры


## 🎮 BoolToVisibilityConverter - Конвертер видимости элементов
#### 📌 Назначение
Конвертер BoolToVisibilityConverter предназначен для преобразования логических значений (bool) в значения видимости WPF-элементов (Visibility). 

Основные применения:
- Динамическое отображение/скрытие элементов интерфейса
- Управление видимостью на основе состояния игры
- Реализация переключения между различными режимами отображения
#### 🔑 Ключевые особенности
| Характеристика       | Описание                                                                 |
|:--------------------:|--------------------------------------------------------------------------|
| **Тип преобразования** | Одностороннее (`bool` → `Visibility`)                                   |
| **Инверсия логики**  | Поддерживается через параметр `ConverterParameter="Invert"`             |
| **Режимы видимости** | `Visibility.Visible` (видимый) / `Visibility.Collapsed` (скрытый)       |
| **Исключения**       | `NotImplementedException` для `ConvertBack`                             |
#### 🎮 Основные методы

| Метод                                                                 | Входные параметры                          | Возвращаемое значение       | Логика работы                                                                 |
|-----------------------------------------------------------------------|--------------------------------------------|-----------------------------|-------------------------------------------------------------------------------|
| **Convert(object value, Type targetType, object parameter, CultureInfo culture)** | `value`: `bool` (исходное значение)       | `Visibility`                | Преобразует `true` → `Visible`, `false` → `Collapsed`. Если передан параметр `"Invert"`, инвертирует логику. |

# View (Пользовательский интерфейс)
XAML-файлы и связанные с ними окна:

StartWindow.xaml    - Стартовое окно
LeaderboardWindow.xaml - Таблица рекордов
DifficulitySelectionWindow.xaml - Выбор уровня сложности
PinkMessageBox.xaml



## 🚀 App.xaml - Главный конфигурационный файл приложения
#### 📌 Назначение
Файл App.xaml является:
- Точкой входа WPF-приложения
- Контейнером для глобальных ресурсов
- Местом для настройки стартового окна
- Центральным местом для определения глобальных стилей и конвертеров

#### 🔑 Ключевые свойства App.xaml
| Характеристика  | Описание                                                                 |
|:---------------:|--------------------------------------------------------------------------|
| **StartupUri**  | Определяет стартовое окно приложения (`StartWindow.xaml`)               |
| **xmlns**       | Пространства имен для XAML                                              |
| **xmlns:local** | Доступ к локальным классам (`clr-namespace:SnakeGame`)                  |
| **Resources**   | Контейнер для глобальных ресурсов (стилей, шаблонов, конвертеров)       |

#### 🛠 Основные функции

| Функциональность     | Описание                                                                 |
|:--------------------:|--------------------------------------------------------------------------|
| **Инициализация**    | Автоматический запуск `StartWindow` при старте приложения               |
| **Управление ЖЦ**    | Контроль жизненного цикла всего приложения                              |
| **Ресурсы**          | Централизованное хранение общих стилей и конвертеров                    |
| **Пространства имен**| Доступ к пользовательским классам через XAML            



## MainWindow.xaml     - Основное игровое окно
#### 🎮 Описание интерфейса
Основное окно:
- Стильный дизайн с градиентными элементами и закругленными углами
- Адаптивная разметка с тремя основными секциями:

 1.Заголовок с названием игры

 2.Игровое поле с змейкой и едой

 3.Панель управления и статистики

#### 🔑 Ключевые элементы

| Элемент          | Характеристики                          |
|------------------|----------------------------------------|
|  Игровое поле  | 600×340px, плавная анимация            |
|  Управление    | Стрелки клавиатуры                     |
|  Визуализация  | ItemsControl + data binding            |
|  Счёт          | Текущие очки + рекорд                  |
|  Скорость      | 3 уровня сложности                     |

Специальные режимы:
- Стартовый экран с кнопкой Start
- Экран паузы с возможностью:
- Продолжить игру
- Перезапустить игру
- Просмотреть таблицу лидеров
- Сменить пользователя
- Выйти из игры

## 🍓 LoginWindow - Oкно входа

#### 🔑 Основные элементы

| Элемент               | Описание                          |
|-----------------------|-----------------------------------|
| UsernameTextBox    | Поле для ввода имени пользователя |
| PasswordBox        | Поле для ввода пароля            |
| **Кнопка "Войти"**    | Авторизация пользователя         |
| **Кнопка "Регистрация"** | Переход к форме регистрации     |

# 🍓 DifficultySelectionWindow – Окно выбора сложности  

# 🔑 Основные элементы

| Элемент             | Описание                                                |
|---------------------|---------------------------------------------------------|
| Кнопка "Медленно"   | Выбор медленной скорости, команда SetSlowCommand       |
| Кнопка "Средне"     | Выбор средней скорости, команда SetMediumCommand       |
| Кнопка "Быстро"     | Выбор быстрой скорости, команда SetFastCommand         |

# 💖 PinkMessageBox – Кастомное диалоговое окно

# 🔑 Основные элементы

| Элемент             | Описание                                                        |
|---------------------|-----------------------------------------------------------------|
| Кнопка "ОК"         | Закрывает окно, команда OkCommand (для информационных сообщений |
| Кнопка "Да"         | Возвращает MessageBoxResult.Yes, команда YesCommand             |
| Кнопка "Нет"        | Возвращает MessageBoxResult.No, команда NoCommand               |


